"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[60],{24:(e,t,r)=>{r.d(t,{R:()=>l});var a=r(2803);let o={lat:5.821944,lng:-73.029722},n={lat:5.821944,lng:-73.029722},i=[],l=(0,a.v)(function(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];return{...(e=>({title:"",objective:"",description:"",setTitle:t=>e({title:t}),setObjective:t=>e({objective:t}),setDescription:t=>e({description:t}),setPOIData:t=>e(e=>({...e,...t}))}))(...t),...((e,t)=>({mapInstance:null,center:o,zoom:16,setMapInstance:t=>e({mapInstance:t}),updateMapState:t=>{let{center:r,zoom:a}=t;return e({center:r,zoom:a})},zoomIn:()=>{let{mapInstance:r}=t();if(r){var a;let t=Math.min(20,(null!=(a=r.getZoom())?a:16)+1);r.setZoom(t),e({zoom:t})}},zoomOut:()=>{let{mapInstance:r}=t();if(r){var a;let t=Math.max(1,(null!=(a=r.getZoom())?a:16)-1);r.setZoom(t),e({zoom:t})}},clearMapComponents:()=>{let{mapInstance:e}=t();(null==e?void 0:e.data)&&e.data.forEach(t=>e.data.remove(t)),console.log("Map components cleared.")}}))(...t),...((e,t)=>({geolocationAvailable:!1,userLocation:n,setGeolocation:function(t){let r=!(arguments.length>1)||void 0===arguments[1]||arguments[1];return e({userLocation:t,geolocationAvailable:r})},recenterMap:()=>{let{mapInstance:e,userLocation:r,updateMapState:a}=t();e&&r&&(e.setCenter(r),e.setZoom(16),a({center:r,zoom:16}))},fetchUserLocation:async()=>{let{setGeolocation:e,recenterMap:r}=t();if(!navigator.geolocation){console.error("Geolocation is not supported by this browser."),e(n,!1);return}try{navigator.geolocation.getCurrentPosition(t=>{let a={lat:t.coords.latitude,lng:t.coords.longitude};e(a,!0),r()},r=>{console.error("Geolocation error:",r.message),e(t().userLocation,!1)},{enableHighAccuracy:!0,timeout:5e3,maximumAge:0})}catch(r){console.error("Error accessing Geolocation API:",r),e(t().userLocation,!1)}}}))(...t),...(e=>({toolMode:"DRAW",setToolMode:t=>e({toolMode:t})}))(...t),...((e,t)=>({selectedIcon:"Pin",selectedIconName:"Pin",placementActive:!1,markers:i,activeMarkerId:null,setSelectedIcon:t=>e({selectedIcon:t}),setSelectedIconName:t=>e({selectedIconName:t}),setMarkers:t=>e({markers:t}),activatePlacementMode:()=>e({placementActive:!0}),finalizeMarker:r=>{let{selectedIcon:a,selectedIconName:o,markers:n}=t(),i={id:Math.random().toString(36).substring(2,6)+Date.now().toString(36),position:r,icon:a,title:o,content:"",background:"#fff",iconColor:"#000",radius:0,checklist:[],isNew:!0,visible:!0,draggable:!1};e({markers:[...n,i],placementActive:!1,activeMarkerId:i.id})},setActiveMarker:t=>e({activeMarkerId:t}),updateMarker:(t,r)=>e(e=>({markers:e.markers.map(e=>e.id===t?{...e,...r,isNew:!1}:e)})),toggleMarkerVisibility:t=>e(e=>({markers:e.markers.map(e=>e.id===t?{...e,visible:!e.visible}:e)})),deleteMarker:t=>e(e=>({markers:e.markers.filter(e=>e.id!==t),activeMarkerId:e.activeMarkerId===t?null:e.activeMarkerId}))}))(...t),...((e,t)=>({draw:null,activeTool:null,drawingInProgress:!1,drawings:[],activeDrawingId:null,deleteRequestId:null,setActiveTool:t=>{e({activeTool:t,drawingInProgress:!!t})},setDrawings:t=>{e({drawings:t})},finalizeDrawing:(t,r)=>{let a={id:Math.random().toString(36).substring(2,6)+Date.now().toString(36),type:t,geometry:r,title:"Nuevo Dibujo",description:"",isNew:!0,visible:!0};e(e=>({drawings:[...e.drawings,a],drawingInProgress:!1,activeDrawingId:a.id,activeTool:null}))},updateDrawings:t=>{t&&e(e=>({drawings:t.map(t=>{var r,a,o,n,i,l,c;return{id:t.id,type:null==(r=t.geometry)?void 0:r.type,geometry:t.geometry,properties:t.properties||{},title:(null==(a=t.properties)?void 0:a.name)||"Dibujo",description:(null==(o=t.properties)?void 0:o.description)||"",isNew:null==(l=null==(n=e.drawings.find(e=>e.id===t.id))?void 0:n.isNew)||l,visible:null==(c=null==(i=e.drawings.find(e=>e.id===t.id))?void 0:i.visible)||c}})}))},setActiveDrawing:t=>e({activeDrawingId:t}),updateDrawing:(t,r)=>e(e=>({drawings:e.drawings.map(e=>e.id===t?{...e,...r,isNew:!1}:e)})),deleteDrawing:t=>e(e=>({drawings:e.drawings.filter(e=>e.id!==t),activeDrawingId:e.activeDrawingId===t?null:e.activeDrawingId})),cancelDrawing:()=>e({activeTool:null,drawingInProgress:!1}),setDrawInstance:t=>{e({draw:t})},deleteById:e=>{let{draw:r}=t();if(!r||!e)return;let a=Array.isArray(e)?e:[e];try{"function"==typeof r.removeFeatures?r.removeFeatures(a):"function"==typeof r.deleteFeature?r.deleteFeature(a):"function"==typeof r.delete?r.delete(a):(console.error("No delete method found on TerraDraw instance"),console.log("Available methods:",Object.keys(r)))}catch(e){console.error("Error deleting feature:",e)}},deleteSelected:()=>{let{draw:e,deleteById:r}=t();if(e)try{var a;let t=(null==(a=e.getSelectedIds)?void 0:a.call(e))||[];t.length&&r(t)}catch(e){console.error("Error deleting selected features:",e)}},clearAll:()=>{let{draw:e}=t();if(e)try{var r;null==(r=e.clear)||r.call(e)}catch(e){console.error("Error clearing all features:",e)}},saveSnapshot:()=>{let{draw:e}=t();if(!e)return null;try{var r;return(null==(r=e.getSnapshot)?void 0:r.call(e))||null}catch(e){return console.error("Error saving snapshot:",e),null}},restoreSnapshot:e=>{let{draw:r}=t();if(r&&e)try{var a;null==(a=r.addFeatures)||a.call(r,e)}catch(e){console.error("Error restoring snapshot:",e)}},triggerDelete:t=>e({deleteRequestId:t}),clearDeleteRequest:()=>e({deleteRequestId:null})}))(...t),...(e=>({leftSidebarVisible:!1,rightSidebarVisible:!1,interestSidebarVisible:!0,markerSidebarVisible:!1,createSidebarVisible:!1,publishSidebarVisible:!1,navigateSidebarVisible:!1,layerSidebarVisible:!0,setSidebarVisibility:(t,r)=>e({["".concat(t,"SidebarVisible")]:r}),toggleSidebar:t=>e(e=>({["".concat(t,"SidebarVisible")]:!e["".concat(t,"SidebarVisible")]}))}))(...t),...((e,t)=>({currentMap:null,isVisible:!1,hasLink:!1,setCurrentMapMetadata:t=>e({currentMap:t}),setisVisible:t=>e({isVisible:t}),setHasLink:t=>e({hasLink:t}),updateCurrentMapMetadata:t=>e(e=>({currentMap:e.currentMap?{...e.currentMap,...t,updatedAt:Date.now()}:null})),clearCurrentMapMetadata:()=>e({currentMap:null}),hasCurrentMapMetadata:()=>!!t().currentMap}))(...t)}})},1615:(e,t,r)=>{r.d(t,{cn:()=>n});var a=r(7235),o=r(7559);function n(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];return(0,o.QP)((0,a.$)(t))}},2019:(e,t,r)=>{r.d(t,{NR:()=>g,E6:()=>v,D4:()=>m,g0:()=>b,xF:()=>f,qO:()=>p});var a=r(4581),o=r(796);let n=(0,o.aU)(a.y);async function i(e,t){let r=(0,o.rJ)(n,e);return(await (0,o.gS)(r,{...t,createdAt:new Date})).id}async function l(e,t,r){try{let a=(0,o.rJ)(n,e);console.log("col ref",a);let i=t?(0,o.P)(a,(0,o._M)(t,"==",r)):a;console.log("q",i);let l=await (0,o.GG)(i);return console.log("q",i),l.docs.map(e=>({id:e.id,...e.data()}))}catch(e){return console.log(e),[]}}async function c(e,t){let r=(0,o.H9)(n,e);await (0,o.mZ)(r,{...t,updatedAt:new Date})}async function s(e){let t=(0,o.H9)(n,e);await (0,o.kd)(t)}let d="users",u="pois";async function g(e,t){let r="".concat(d,"/").concat(e,"/").concat(u);if((await l(r)).length>=3)throw Error("Maximum of ".concat(3," POIs reached."));return await i(r,t)}async function p(e,t,r){let a="".concat(d,"/").concat(e,"/").concat(u,"/").concat(t);await c(a,r)}async function v(e,t){let r="".concat(d,"/").concat(e,"/").concat(u,"/").concat(t);await s(r)}async function m(e){let t="".concat(d,"/").concat(e,"/").concat(u);return console.log("path",t),await l(t)}async function b(){try{let e=(0,o.P)((0,o.Cs)(n,"pois")),t=(await (0,o.GG)(e)).docs.map(e=>({id:e.id,...e.data()}));return console.log("Successfully retrieved ".concat(t.length," POIs.")),t}catch(e){return console.error("Error retrieving POIs using Collection Group Query:",e),[]}}async function f(e,t){try{let r=(0,o.H9)(n,"users",t,"pois",e),a=await (0,o.x7)(r);if(!a.exists())return console.warn("POI with ID ".concat(e," not found for user ").concat(t,".")),null;return{id:a.id,...a.data()}}catch(e){return console.error("Error fetching POI for specific user:",e),null}}},4581:(e,t,r)=>{r.d(t,{y:()=>a});let a=(0,r(254).Wp)({apiKey:"AIzaSyAkX8Y0uLLIRpJsOA2SL_b_JItkfGvQabU",authDomain:"miruta-bf9cc.firebaseapp.com",projectId:"miruta-bf9cc",storageBucket:"miruta-bf9cc.firebasestorage.app",messagingSenderId:"95944970139",appId:"1:95944970139:web:405b199a75d60542b31b3e"})}}]);