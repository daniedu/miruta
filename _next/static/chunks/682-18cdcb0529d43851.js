"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[682],{2399:(e,t,a)=>{a.r(t),a.d(t,{LeftCircleMarkerLayer:()=>N,RightCircleMarkerLayer:()=>y});var r=a(4248),s=a(4564),i=a(926),l=a(1615);function n(e){let{delayDuration:t=0,...a}=e;return(0,r.jsx)(i.Kq,{"data-slot":"tooltip-provider",delayDuration:t,...a})}function o(e){let{...t}=e;return(0,r.jsx)(n,{children:(0,r.jsx)(i.bL,{"data-slot":"tooltip",...t})})}function d(e){let{...t}=e;return(0,r.jsx)(i.l9,{"data-slot":"tooltip-trigger",...t})}function c(e){let{className:t,sideOffset:a=0,children:s,...n}=e;return(0,r.jsx)(i.ZL,{children:(0,r.jsxs)(i.UC,{"data-slot":"tooltip-content",sideOffset:a,className:(0,l.cn)("bg-foreground text-background animate-in fade-in-0 zoom-in-95 data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=closed]:zoom-out-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 z-50 w-fit origin-(--radix-tooltip-content-transform-origin) rounded-md px-3 py-1.5 text-xs text-balance",t),...n,children:[s,(0,r.jsx)(i.i3,{className:"bg-foreground fill-foreground z-50 size-2.5 translate-y-[calc(-50%_-_2px)] rotate-45 rounded-[2px]"})]})})}var u=a(6963),x=a(2698),m=a(1513),h=a(6885),f=a(7292),g=a(245),p=a(1581),j=a(24),b=a(5539),v=a(2019),w=a(9233);let N=e=>{let{elements:t=[{id:"1",title:"Marcadores",customIcon:(0,r.jsx)(u.A,{className:"w-10 h-10 text-gray-700"}),sidebar:"marker"},{id:"3",title:"Capas",customIcon:(0,r.jsx)(x.A,{className:"w-10 h-10 text-gray-700"}),sidebar:"layer"}]}=e,a=(0,j.R)(e=>e.toggleSidebar);return(0,r.jsx)(n,{children:(0,r.jsx)("div",{className:"absolute top-4 left-4 flex flex-col gap-3 p-2 pointer-events-auto z-1",children:t.map(e=>(0,r.jsxs)(o,{children:[(0,r.jsx)(d,{asChild:!0,children:(0,r.jsx)("button",{onClick:()=>null==a?void 0:a(e.sidebar),className:"w-18   h-18   rounded-full bg-white flex items-center justify-center shadow-md border border-gray-200 transform transition-transform duration-200 hover:scale-110 cursor-pointer",children:e.customIcon?e.customIcon:(0,r.jsx)(u.A,{className:"w-5 h-5 text-gray-700"})})}),(0,r.jsx)(c,{side:"right",className:"text-xs",children:e.title||"Sin t\xedtulo"})]},e.id))})})},y=e=>{let{elements:t=[{id:"1",title:"Punto de Interes",customIcon:(0,r.jsx)(m.A,{className:"w-10 h-10 text-gray-700"}),sidebar:"interest"},{id:"2",title:"Marcadores y Dibujos",customIcon:(0,r.jsx)(h.A,{className:"w-10 h-10 text-gray-700"}),sidebar:"create"},{id:"3",title:"Navegacion",customIcon:(0,r.jsx)(f.A,{className:"w-10 h-10 text-gray-700"}),sidebar:"navigate"},{id:"4",title:"Publicar o Compartir",customIcon:(0,r.jsx)(g.A,{className:"w-10 h-10 text-gray-700"}),sidebar:"publish"}]}=e,[a,i]=(0,s.useState)(!1),l=(0,j.R)(e=>e.toggleSidebar),x=(0,b.k)(e=>e.user),N=(0,j.R)(e=>e.currentMap),y=(0,j.R)(e=>e.updateCurrentMapMetadata),k=(0,j.R)(e=>e.title),A=(0,j.R)(e=>e.objective),z=(0,j.R)(e=>e.description),R=(0,j.R)(e=>e.isVisible),S=(0,j.R)(e=>e.hasLink),C=(0,j.R)(e=>e.markers),I=(0,j.R)(e=>e.drawings),M=e=>{let t=JSON.parse(JSON.stringify(e));return t.geometry&&Array.isArray(t.geometry.coordinates)&&(t.geometry.coordinates=JSON.stringify(t.geometry.coordinates)),t};return(0,r.jsx)(n,{children:(0,r.jsxs)("div",{className:"absolute top-4 right-4 flex flex-col gap-3 p-2 pointer-events-auto z-1",children:[t.map(e=>(0,r.jsxs)(o,{children:[(0,r.jsx)(d,{asChild:!0,children:(0,r.jsx)("button",{onClick:()=>null==l?void 0:l(e.sidebar),className:"w-18   h-18   rounded-full bg-white flex items-center justify-center shadow-md border border-gray-200 transform transition-transform duration-200 hover:scale-110 cursor-pointer",children:e.customIcon?e.customIcon:(0,r.jsx)(u.A,{className:"w-5 h-5 text-gray-700"})})}),(0,r.jsx)(c,{side:"right",className:"text-xs",children:e.title||"Sin t\xedtulo"})]},e.id)),(0,r.jsxs)(o,{children:[(0,r.jsx)(d,{asChild:!0,children:(0,r.jsx)("button",{onClick:async()=>{i(!0);let e=C[0]||{lat:0,lng:0},t=I.map(M),a={id:null==N?void 0:N.id,lat:e.position.lat,lng:e.position.lng,title:k,objective:A,description:z,isVisible:R,hasLink:S,markers:C,drawings:t};try{if((null==N?void 0:N.mode)==="new"){let e=await (0,v.NR)(null==x?void 0:x.uid,{id:a.id});console.log(e),y({mode:"edit",id:e}),await (0,v.qO)(null==x?void 0:x.uid,e,{...a,id:e}),console.log("New POI created successfully.")}else(null==N?void 0:N.mode)==="edit"?(await (0,v.qO)(null==x?void 0:x.uid,N.id,a),console.log("POI updated successfully.")):console.warn("Attempted to save with unknown map mode:",null==N?void 0:N.mode)}catch(e){console.error("Error during POI save operation:",e)}finally{i(!1)}},className:"w-18 h-18 rounded-full bg-white flex items-center justify-center shadow-md border border-gray-200 transform transition-transform duration-200 hover:scale-110 cursor-pointer",children:a?(0,r.jsx)(w.y,{}):(0,r.jsx)(p.A,{className:"w-10 h-10 text-gray-700"})})}),(0,r.jsx)(c,{side:"right",className:"text-xs",children:"Guardar"})]},"guardar")]})})}},9233:(e,t,a)=>{a.d(t,{y:()=>l});var r=a(4248),s=a(8650),i=a(1615);function l(e){let{className:t,...a}=e;return(0,r.jsx)(s.A,{role:"status","aria-label":"Loading",className:(0,i.cn)("size-4 animate-spin",t),...a})}},9608:(e,t,a)=>{a.r(t),a.d(t,{LayerManagerPanel:()=>y,getTypeIcon:()=>k});var r=a(4248);a(4564);var s=a(8842),i=a(88),l=a(6963),n=a(3561),o=a(2821),d=a(6405),c=a(7029),u=a(30),x=a(3867),m=a(5866),h=a(3912),f=a(7452),g=a(24),p=a(2765),j=a(9827),b=a(1615);function v(e){let{className:t,...a}=e;return(0,r.jsx)(j.YZ,{"data-slot":"resizable-panel-group",className:(0,b.cn)("flex h-full w-full data-[panel-group-direction=vertical]:flex-col",t),...a})}function w(e){let{...t}=e;return(0,r.jsx)(j.Zk,{"data-slot":"resizable-panel",...t})}function N(e){let{withHandle:t,className:a,...s}=e;return(0,r.jsx)(j.TW,{"data-slot":"resizable-handle",className:(0,b.cn)("bg-border focus-visible:ring-ring relative flex w-px items-center justify-center after:absolute after:inset-y-0 after:left-1/2 after:w-1 after:-translate-x-1/2 focus-visible:ring-1 focus-visible:ring-offset-1 focus-visible:outline-hidden data-[panel-group-direction=vertical]:h-px data-[panel-group-direction=vertical]:w-full data-[panel-group-direction=vertical]:after:left-0 data-[panel-group-direction=vertical]:after:h-1 data-[panel-group-direction=vertical]:after:w-full data-[panel-group-direction=vertical]:after:translate-x-0 data-[panel-group-direction=vertical]:after:-translate-y-1/2 [&[data-panel-group-direction=vertical]>div]:rotate-90",a),...s,children:t&&(0,r.jsx)("div",{className:"bg-border z-10 flex h-4 w-3 items-center justify-center rounded-xs border",children:(0,r.jsx)(p.A,{className:"size-2.5"})})})}let y=e=>{let{}=e,t=(0,g.R)(e=>e.layerSidebarVisible),a=(0,g.R)(e=>e.toggleSidebar),u=(0,g.R)(e=>e.drawings),x=(0,g.R)(e=>e.triggerDelete),m=(0,g.R)(e=>e.markers),h=(0,g.R)(e=>e.toggleMarkerVisibility),f=(0,g.R)(e=>e.deleteMarker),p=(0,g.R)(e=>e.setActiveMarker),j=e=>{p(e),a("marker")};if(console.log(u),t)return(0,r.jsxs)(v,{direction:"vertical",className:"h-[96vh] max-h-[96vh] w-[260px] max-w-[260px] rounded-lg border bg-white shadow-xl overflow-hidden absolute top-4 left-4 z-10",children:[(0,r.jsxs)(w,{defaultSize:50,minSize:20,maxSize:80,children:[(0,r.jsx)("div",{className:"p-2 flex flex-row items-center justify-between",children:(0,r.jsx)(i.A,{onClick:()=>a("layer"),className:"absolute right-2 top-2 w-8 h-8",color:"black"})}),(0,r.jsxs)("h3",{className:"pb-4 pl-4 font-semibold flex items-center gap-2",children:[(0,r.jsx)(l.A,{className:"w-4 h-4"})," Marcadores"]}),(0,r.jsx)("div",{className:"flex flex-col h-full overflow-y-auto px-4 pb-4",children:(0,r.jsx)("div",{className:"space-y-2",children:m.map(e=>(0,r.jsxs)("div",{className:"flex items-center justify-between px-2 bg-white border border-gray-200 rounded-xl shadow-sm hover:shadow-md transition cursor-pointer",onClick:()=>null==j?void 0:j(e.id),children:[(0,r.jsxs)("div",{className:"flex items-center gap-3",children:[(0,r.jsx)("div",{className:"w-4 h-4 rounded-full border",style:{background:e.background}}),(0,r.jsxs)("div",{className:"flex flex-col max-w-[100px]",children:[(0,r.jsx)("span",{className:"font-medium text-gray-800 truncate",children:e.title||"Sin nombre"}),e.title&&(0,r.jsx)("span",{className:"text-xs text-gray-500 truncate",children:e.title})]})]}),(0,r.jsxs)("div",{className:"flex items-center ",children:[e.draggable&&(0,r.jsx)("span",{className:"text-xs px-2 py-0.5 bg-emerald-100 text-emerald-800 rounded-full",children:"Drag"}),(0,r.jsx)(s.$,{size:"icon",variant:"ghost",onClick:t=>{t.stopPropagation(),null==h||h(e.id)},title:e.visible?"Ocultar":"Mostrar",children:e.visible?(0,r.jsx)(n.A,{className:"w-4 h-4"}):(0,r.jsx)(o.A,{className:"w-4 h-4"})}),(0,r.jsx)(s.$,{size:"icon",variant:"ghost",onClick:t=>{t.stopPropagation(),null==f||f(e.id)},title:"Eliminar",children:(0,r.jsx)(d.A,{className:"w-4 h-4 text-red-500"})})]})]},e.id))})})]}),(0,r.jsx)(N,{}),(0,r.jsx)(w,{defaultSize:50,minSize:20,maxSize:80,children:(0,r.jsx)(v,{direction:"vertical",className:"h-full",children:(0,r.jsx)(w,{defaultSize:50,minSize:10,maxSize:90,children:(0,r.jsxs)("div",{className:"flex flex-col h-full overflow-y-auto p-4",children:[(0,r.jsxs)("h3",{className:"font-semibold mb-3 flex items-center gap-2",children:[(0,r.jsx)(c.A,{className:"w-4 h-4"})," Geometria"]}),(0,r.jsx)("div",{className:"space-y-2",children:u.map(e=>{let t=k(null==e?void 0:e.properties.mode);return(0,r.jsxs)("div",{className:"flex flex-row items-center justify-start p-2 bg-muted/40 rounded-lg hover:bg-muted/60 transition cursor-pointer gap-4",children:[(0,r.jsx)(t,{}),(0,r.jsx)("span",{className:"truncate",children:e.title||"Sin nombre"}),(0,r.jsxs)("div",{className:"ml-auto flex items-center ",children:[(0,r.jsx)(s.$,{size:"icon",variant:"ghost",onClick:t=>{t.stopPropagation(),null==h||h(e.id)},title:e.visible?"Ocultar":"Mostrar",children:e.visible?(0,r.jsx)(n.A,{className:"w-4 h-4"}):(0,r.jsx)(o.A,{className:"w-4 h-4"})}),(0,r.jsx)(s.$,{size:"icon",variant:"ghost",onClick:t=>{t.stopPropagation(),null==x||x(e.id)},title:"Eliminar",children:(0,r.jsx)(d.A,{className:"w-4 h-4 text-red-500"})})]})]},e.id)})})]})})})})]})};function k(e){return({point:u.A,rectangle:x.A,polygon:m.A,linestring:h.A,circle:f.A})[e]||f.A}}}]);